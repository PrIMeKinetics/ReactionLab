function [f,u] = conv_factor(units)%[conversionFactor,correctUnits] = conv_factor(givenUnits)% return conversion factor, f, %    from BaseUnits to given units% ie, x[givenUnits] = y[BaseUnits] * f[givenUnits/BaseUnits]% Copyright 1999-2010 Michael Frenklach% $Revision: 1.1 $% Last modified: May 6, 2010% Last modified: July 22, 2013  Matt Speight (changed line 61)%   units = strrep(units,char(179),'3');%   units = strrep(units,char(181),'micro');   switch lower(units)      case {'mol/cm3' 'mol cm-3' 'km' 'kmol/l' 'kmol/dm3' 'kmol dm-3'}         f = 1;         u = 'mol/cm3';      case {'cm3/mol' 'cm3 mol-1' 'kmol l' 'l/kmol' 'cm/molecule'}         f = 1;         u = 'cm3/mol';      case {'molecule/cm3' 'cm-3' '1/cm3'}         f = ReactionLab.PhysConst.avogadro;         u = 'cm-3';      case {'cm3/molecule' 'cm3'}         f = 1/ReactionLab.PhysConst.avogadro;         u = 'cm3';      case {'m' 'mol/l' 'mol l-1' 'mol/dm3' 'mol dm-3' 'kmol/m3' 'kmol m-3'}         f = 1e+3;         u = 'M';      case {'m-1' 'l/mol' 'l mol-1' 'dm3/mol' 'dm3 mol-1' 'm3/kmol' 'm3 kmol-1'}         f = 1e-3;         u = 'M-1';      case {'mol/m3' 'mol m-3'}         f = 1e+6;         u = 'mol/m3';      case {'m3/mol' 'm3 mol-1'}         f = 1e-6;         u = 'm3/mol';      case {'s' 'sec'}         f = 1;         u = 's';      case {'s-1' 'sec-1'}         f = 1;         u = 's-1';      case 'min'         f = 1/60;         u = 'min';      case 'min-1'         f = 60;         u = 'min-1';      case {'h' 'hr' 'hour'}         f = 1/3600;         u = 'hr';      case {'h-1' 'hr-1'}         f = 3600;         u = 'hr-1';      case {'ms' 'msec' 'millisec'}         f = 1e+3;         u = 'ms';%       case {'microsec' [char(181) 's'] [char(181) 'sec']}% wms   case {'microsec' 'micros'}      case {'microsec' 'micros' [char(181) 's'] [char(181) 'sec']}         f = 1e+6;         u = 'microsec';      case 'atm'         f = 1;         u = 'atm';      case 'bar'         f = 1.01325;         u = 'bar';      case 'kpa'         f = 101.325;         u = 'kPa';      case 'pa'         f = 101325;         u = 'pa';      case 'mpa'         f = 0.101325;         u = 'Mpa';      case 'torr'         f = 760;         u = 'torr';      case {'mole fraction' 'mol fraction' 'volume fraction' 'vol fraction' 'partial pressure'}         f = 1;         u = 'mole fraction';      case 'ppm'         f = 1e+6;         u = 'ppm';      case 'ppb'         f = 1e+9;         u = 'ppm';      otherwise         error(['undefined units ' units])   endreturn