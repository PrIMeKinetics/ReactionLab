function thArray = readNasa9(fileName,bibPrimeId)%Nasa9ObjArray = readNasa9(fileName,bibPrimeId)%% read NASA 9-coefficient polynomials%   create and return Nasa9 object% Copyright 1999-2010 Michael Frenklach% $Revision: 1.0 $% Last modified: March 20, 2010fid = fopen(fileName,'rt');if fid < 0   error(['file ' fileName ' couldn''t be open'])endth = ReactionLab.ThermoData.Nasa9();[~,name,ext] = fileparts(fileName);th.DataRef = name;if nargin > 1   th.DataRefId = bibPrimeId;endiRec = 0;fileDir = dir(which(fileName));numBytes = fileDir.bytes;strName = strrep(name,'_','\_');Hwait = waitbar(0,['Loading   ' strName ext]);thArray = ReactionLab.ThermoData.Nasa9.empty(1,0);while ~feof(fid)   line = fgetl(fid);   line = strjust(line,'left');   if isempty(line) || line(1)=='!'   elseif strncmpi(line,'THERMO',6)      line = fgetl(fid);   elseif strncmpi(line,'END',3)      break   else      iRec = iRec + 1;      thFilled = LOCAL_readRecord(th,line,fid);      thArray(iRec) = thFilled;      waitbar(iRec*350/numBytes);   endendclose(Hwait);fclose(fid);returnfunction th = LOCAL_readRecord(th,line,fid)% read a species record   [formula,comment] = strtok(line);   th.SpeciesKey = strtrim(formula);   th.Id = strtrim(comment);   line = fgetl(fid);            % read next line   numTintervals = str2double(line(1:2));   th.ReferenceCode = strtrim(line(4:9));   el.symbol = '';   el.number = [];   for i = 1:5      ii = 3 + 8*i;      el = LOCAL_elem(el,line(ii:ii+7));   end   th.SpeciesElements = el;   th.Phase = str2double(strtrim(line(51:52)));   for n = 1:numTintervals     line = fgetl(fid);            % read next line      poly(n).Trange = str2num(line(1:22));      %set(th,'powers',str2num(line(24:63)));     line = fgetl(fid);            % read next line      coefStr = line(1:80);     line = fgetl(fid);            % read next line      coefStr = strrep(lower([coefStr line([1:32 49:80])]),'d','e');      poly(n).coef = sscanf(coefStr,'%f',9)';   end   th.Data = poly;returnfunction el = LOCAL_elem(el,str)% check and read-in elements (a2,f6.2)   elem.symbol = strtrim(str(1:2));   if ~isempty(elem.symbol) && all(isletter(elem.symbol))      elem.number = str2double(str(3:8));      el = mmap(el,'add',elem);   endreturn