function [eqK,t,u,dH,dS,dG] = keq(r,T,units)%[Keq,T,unitsKeq,deltaH,deltaS,deltaG] = keq(ReactionObj,T,units)%                     --in K--% Copyright 1999-2011 Michael Frenklach% $Revision: 1.0 $% Last modified: January 2, 2011[y,t] = r.Thermo.eval(T,{'h','K';'s','K'});dH = y(1,:);dS = y(2,:);dG = dH - t.*dS;eqK = exp(-dG./t);delta_n = r.dN;if delta_n == 0   u = '';elseif strcmpi(units,'atm')   u = ['atm^' num2str(delta_n)];  % return Kpelse   if strncmpi(units,'mol',3)      units = 'atm_cm3/mol_k';      u = ['(mol/cm3)^' num2str(delta_n)];   else      units = 'atm_cm3/k';      u = ['cm-3^' num2str(delta_n)];   end   gasConst = ReactionLab.PhysConst.univR(units);   eqK = eqK./(gasConst.*t).^delta_n;end