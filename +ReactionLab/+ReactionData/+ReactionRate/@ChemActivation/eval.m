function [y,u] = eval(k,T,kUnits,P,unitsP)%[y,units] = eval(ChemActivationObj,T,kUnits,P,unitsP)% evaluates unimolecular rate coefficient at given T and P%%y = eval(k,T,kUnits,P,unitsP)    unitsP = 'atm|torr|bar'%y = eval(k,T,''    ,P,unitsP)    in cm3/mol_s%y = eval(k,T,kUnits,0)           low-P rate coef%y = eval(k,T,kUnits,inf)        high-P rate coef% Copyright 1999-2010 Michael Frenklach% $Revision: 1.1 $% Last modified: May 7, 2010if ischar(P), P = str2num(P); end[k_0,u] = k.Low.eval(T,kUnits);if P == 0       % low-pressure limit   y = k_0;elseif isinf(P) % high-pressure limit   [y,u] = k.High.eval(T,kUnits);else   k_highP = k.High.find('Collider','s00000001');   k_inf = k_highP.eval(T) ./ totalConc;   Pr = k_0 ./ k_inf;   switch lower(k.Fallof.Type)      case 'lindemann'         y = k_0 ./ (1 + Pr);      case {'troe' 'sri'}         y = k_0 ./ (1 + Pr) .* ...         k.Falloff.eval(T,Pr,falloff.data);      otherwise         error(['undefined falloff type: ' falloff.type])   endend      function c = totalConc   % return  c = p/RT      switch lower(unitsP)         case 'atm'         case 'torr'            p = P / 760.;  % convert to atm         case 'bar'            p = P / 1.01325;         otherwise            error(['Incorrect pressure units: ', kUnits])      end      c = p./(Reactionlab.PhysConst.univR('atm_cm3/mol_K') .* T);   endend